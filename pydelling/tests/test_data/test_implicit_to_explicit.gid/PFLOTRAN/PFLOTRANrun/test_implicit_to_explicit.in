#---PFLOTRAN input file Generated by iGP---
#---For more information, visit http://www.amphos21.com/---

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE RICHARDS
    /
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
    /
  /
END

SUBSURFACE

#=========================== flow mode ========================================

#=========================== checkpointing ====================================

#=========================== chemistry ========================================
CHEMISTRY
  PRIMARY_SPECIES
    H+
        Tracer_Inlet
  /

  DATABASE ./hanford.dat
  LOG_FORMULATION
#  OPERATOR_SPLITTING
  ACTIVITY_COEFFICIENTS TIMESTEP
  OUTPUT
    PH
    all
    TOTAL
  /
END

#=========================== solver options ===================================

#=========================== discretization ===================================
GRID
  TYPE unstructured_explicit ./input_files/explicit_mesh.mesh
  MAX_CELLS_SHARING_A_VERTEX 100
END

#=========================== fluid properties =================================
FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9
END

#=========================== material properties ==============================
MATERIAL_PROPERTY oxide-ore
  ID 1
  POROSITY 0.05d0
  TORTUOSITY 1.d0
  PERMEABILITY
    PERM_ISO 1.5d-13
  /
  CHARACTERISTIC_CURVES default
END
#=========================== saturation functions =============================
CHARACTERISTIC_CURVES default
  SATURATION_FUNCTION VAN_GENUCHTEN
    M 0.286
    ALPHA  1.9401d-4
    LIQUID_RESIDUAL_SATURATION 0.115
  /
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
    M 0.286
    LIQUID_RESIDUAL_SATURATION 0.115
  /
END

#=========================== output options ===================================
OUTPUT
  #PERIODIC_OBSERVATION TIMESTEP 1
  PERIODIC TIME 0.01 y
  #FORMAT TECPLOT BLOCK #Uncomment to export in TECPLOT BLOCK format
  #VELOCITY_AT_CENTER
  Format HDF5 MULTIPLE_FILES
  Format VTK
END

#=========================== times ============================================
TIME
  FINAL_TIME 0.25 y
  INITIAL_TIMESTEP_SIZE 1.d-3 s
  MAXIMUM_TIMESTEP_SIZE 0.01 y
END

#=========================== regions ==========================================
REGION all
  COORDINATES
    -1d20 -1d20 -1d20
    1d20 1d20 1d20
  /
END
REGION Pwall
  FILE ./input_files/Pwall.ex
END


#=========================== observation points ===============================

#=========================== flow conditions ==================================
FLOW_CONDITION initial
  TYPE
    PRESSURE hydrostatic
  /
  PRESSURE 101293
  DATUM 0.d0 0.d0 5.805067282090795d0
END

FLOW_CONDITION Pwall
  TYPE
    PRESSURE Dirichlet
  /
  PRESSURE 101293
/


#=========================== transport conditions =============================

TRANSPORT_CONDITION initial
  TYPE zero_gradient
  CONSTRAINT_LIST
    0.d0 initial
  /
END

TRANSPORT_CONDITION Pwall
  TYPE Dirichlet_zero_gradient
  CONSTRAINT_LIST
    0.d0 inlet
  /
END



#=========================== constraints ======================================
CONSTRAINT initial
  CONCENTRATIONS
    H+         8.d0    pH
        Tracer_Inlet  1.0e-10 T
  /
 END

CONSTRAINT inlet
  CONCENTRATIONS
    H+         1.d0    pH
        Tracer_Inlet  1.0 T
  /
END

#=========================== condition couplers ===============================

# default initial condition
INITIAL_CONDITION
  FLOW_CONDITION initial
  TRANSPORT_CONDITION initial
  REGION all
END


BOUNDARY_CONDITION Pwall
  FLOW_CONDITION Pwall
  TRANSPORT_CONDITION Pwall
  REGION Pwall
END


#=========================== stratigraphy couplers ============================
STRATA
  REGION all
  MATERIAL oxide-ore
END
END_SUBSURFACE
