#---PFLOTRAN input file Generated by iGP---
#---For more information, visit http://www.amphos21.com/---

SIMULATION
  SIMULATION_TYPE SUBSURFACE
  PROCESS_MODELS
    SUBSURFACE_FLOW flow
      MODE RICHARDS
    /
    SUBSURFACE_TRANSPORT transport
      MODE GIRT
    /
  /

  CHECKPOINT
    TIMES y 1.0
    FORMAT HDF5
  /

END

SUBSURFACE

DATASET dirichletpressure
  FILENAME ./input_files/hydrostatic_pressure_top-30.h5
  HDF5_DATASET_NAME hydrostatic_pressure_top
END

DATASET topflow
  FILENAME ./input_files/recharge_top.h5
  HDF5_DATASET_NAME recharge_top
END

#=========================== flow mode ========================================

#=========================== checkpointing ====================================

#=========================== chemistry ========================================
CHEMISTRY
  PRIMARY_SPECIES
        Tracer
  /

  #DATABASE ./hanford.dat
  LOG_FORMULATION
#  OPERATOR_SPLITTING
  ACTIVITY_COEFFICIENTS TIMESTEP
  OUTPUT
    PRIMARY_SPECIES
    TOTAL
  /
END

#=========================== solver options ===================================

#=========================== discretization ===================================
GRID
  TYPE unstructured_explicit ./input_files/explicit.mesh
  max_cells_sharing_a_vertex 100
END
#=========================== fluid properties =================================
FLUID_PROPERTY
  DIFFUSION_COEFFICIENT 1.d-9
END

REFERENCE_PRESSURE -1d20 #101325 #SATURATED

#=========================== material properties ==============================
MATERIAL_PROPERTY Sand
  ID 1
  POROSITY 0.01
  TORTUOSITY 1.0d0
  LONGITUDINAL_DISPERSIVITY 5.0d1
  TRANSVERSE_DISPERSIVITY_V 0.5d1
  TRANSVERSE_DISPERSIVITY_H 0.5d1
  PERMEABILITY
    PERM_X  1.d-15
    PERM_Y  1.d-15
    PERM_Z  1.d-10
  /
  CHARACTERISTIC_CURVES default
END
#=========================== saturation functions =============================
CHARACTERISTIC_CURVES default
  SATURATION_FUNCTION VAN_GENUCHTEN
    M 0.286
    ALPHA  1.9401d-4
    LIQUID_RESIDUAL_SATURATION 0.115
  /
  PERMEABILITY_FUNCTION MUALEM_VG_LIQ
    M 0.286
    LIQUID_RESIDUAL_SATURATION 0.115
  /
END

#EOS WATER
#  DENSITY CONSTANT 1000.d0 
#  VISCOSITY CONSTANT 1.0d-3 
#END

#=========================== output options ===================================
OUTPUT
  #PERIODIC_OBSERVATION TIMESTEP 1
  PERIODIC TIME 0.1 y
  #FORMAT TECPLOT BLOCK #Uncomment to export in TECPLOT BLOCK format
  #VELOCITY_AT_CENTER
  Format HDF5 MULTIPLE_FILES
  VELOCITY_AT_CENTER
  VARIABLES
    LIQUID_PRESSURE
    LIQUID_HEAD
    PERMEABILITY_X
    PERMEABILITY_Y
    PERMEABILITY_Z
    POROSITY
  /  
END

#=========================== times ============================================
TIME
  FINAL_TIME 1.0 y
  INITIAL_TIMESTEP_SIZE 1.d-6 y
  MAXIMUM_TIMESTEP_SIZE 1.d-4 y at 1.d-3 y y
  MAXIMUM_TIMESTEP_SIZE 1.D-3 y at 1.d-2 y y
  MAXIMUM_TIMESTEP_SIZE 1.d-2 y at 1.d-1 y y
END

#=========================== regions ==========================================
REGION all
  COORDINATES
    -1d20 -1d20 -1d20
    1d20 1d20 1d20
  /
END
REGION inlet
  FILE ./input_files/inlet.ex
END

REGION sides
  FILE ./input_files/sides.ex
END

REGION top_below
  FILE ./input_files/top_below.ex
END

REGION top_above
  FILE ./input_files/top_above.ex
END

REGION bottom
  FILE ./input_files/bottom.ex
END

REGION initial
  FILE ./input_files/initial.ex
END

REGION Sand
  FILE ./input_files/Sand.mat
END


#=========================== observation points ===============================
#=========================== flow conditions ==================================
FLOW_CONDITION hydrostatic_cond
  TYPE
      PRESSURE hydrostatic
    /
    DATUM 0.d0 0.d0 30.d0
    PRESSURE 101325.d0
END

FLOW_CONDITION seepage
  TYPE
    PRESSURE SEEPAGE
  /
  DATUM 0.d0 0.d0 30.d0
  PRESSURE 101325.d0
END

FLOW_CONDITION dirichlet
  TYPE
    PRESSURE DIRICHLET
  /
   LIQUID_PRESSURE DATASET dirichletpressure
END

FLOW_CONDITION top_recharge
  TYPE
    LIQUID_FLUX NEUMANN
  /
  LIQUID_FLUX DATASET topflow
END
 
#=========================== constraints ======================================
CONSTRAINT initial_constraint
  CONCENTRATIONS
    Tracer   1.0d-10 T
 /

END

CONSTRAINT inlet_constraint
  CONCENTRATIONS
    Tracer  1.0 T
/
END

#=========================== transport conditions =============================
TRANSPORT_CONDITION background_conc
  TYPE zero_gradient
  CONSTRAINT_LIST
    0.d0 initial_constraint
  /
END

TRANSPORT_CONDITION inlet_conc
  TYPE dirichlet_zero_gradient
  CONSTRAINT_LIST
    0.d0 inlet_constraint
  /
END

#=========================== condition couplers ===============================
# initial condition
INITIAL_CONDITION initial 
  FLOW_CONDITION hydrostatic_cond
  TRANSPORT_CONDITION background_conc
  REGION all
END

BOUNDARY_CONDITION dirichlet_sea
  FLOW_CONDITION dirichlet
  TRANSPORT_CONDITION background_conc
  REGION top_below
END

BOUNDARY_CONDITION top_recharge
  FLOW_CONDITION top_recharge
  TRANSPORT_CONDITION inlet_conc
  REGION top_above
END

#=========================== stratigraphy couplers ============================

STRATA
  REGION Sand
  MATERIAL Sand
END

END_SUBSURFACE
